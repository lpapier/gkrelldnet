
Copyright (c) 2000 by Laurent Papier.  This program is free software
which I release under the GNU General Public License.

Description
===========
gkrelldnet is a monitoring system for Distributed.net client.
(see http://gkrelldnet.sourceforge.net/)

Requirements
============
* a Linux system with kernel support for Unix 98 (the wrapper will only work
  on Linux system but can be ported to other Unix system).
* a working Distributed.net client (see http://www.distributed.net/).
* GKrellM multi-monitor app (0.10.0 or better) (see http://gkrellm.net/).


GKrellDnet provides
===================
* a distibuted.net client wrapper to make it possible to write monitoring
  applets.
  It's possible to monitor the client activity without the
  wrapper but then it's not possible to have the % done in the current
  stub/block. This is because the client doesn't print the crunch'o'meter if
  the client output is not a tty. And this is why I have write this wrapper.

* a GKrellM plugin.
  This plugin features (see also 'Info' in plugin config.)
    - monitor input/output work units
    - monitor current contest
    - percentage done in current block/stub
    - start/stop the dnet client on left/right mouse button click
    - configurable text output
    - configurable command to start on every packet completion

Limitation
==========
* the plugin only support up to 10 CPU ;-)
* on multi-proc. system, you will get inaccurate contest report if not all
  crunchers work on the same contest.
* see TODO file.


Installation
============
compile both the dnet wrapper 'dnetw' and the GKrellDnet plugin:

tar xvfI gkrelldnet-X.Y.tar.bz2
cd gkrelldnet-X.Y
make

install the GKrellDnet plugin in ~/.gkrellm/plugins:
make install

then you need to copy the wrapper 'dnetw' somewhere in your path. I choose to
copy it in the same directory as the distributed.net client and add this
directory in my path.


Usage
=====

First you need to setup your dnet client.
Now, you can use the wrapper to start the dnet client or you can left click in
the GKrellM plugin (be sure that the 'dnetc' executable is in your path).

VERY IMPORTANT:
---------------
dnetw only works if you DO NOT redirect the client output to
a file. The client output MUST be stdout. So check your client configuration.

If you want to redirect the dnet client to a file you must use the dnetw
option '-l'.

ex: dnetw -l dnet.log /tmp/dnetw.log
this command will monitor the dnet client in /tmp/dnetw.log and
redirect the client output to dnet.log.

ex: dnetw /tmp/dnetw.log
this command will monitor the dnet client in /tmp/dnetw.log file and
print the client output on your terminal.

Now, it's possible to give the full dnetc command line to dnetw.
ex: dnetw -c "dnetc -numcpu 2" -l dnet.log /tmp/dnetw.log
this command will force the client to start 2 crunchers.
NOTE: you must enclose the command line with simple or double quotes. (read
your shell man page for more info).

IMPORTANT:
----------
If you start the wrapper by hand: be sure that the file used to monitor the
client is the same as the one used in the monitoring app (GKrellDnet plugin).


How does the wrapper work ?
===========================
This wrapper will write activity information in a file. The last line of this
file contain the most recent information.
The line format is (ASCII text):
current contest
work units in input buffer
work units in output buffer
number of cpu
percentage for cpu 0
percentage for cpu 1
...

ex (1 cpu): RC5 24 2 1 45
RC5 contest, 24 work units in input buffer, 2 in output buffer, 1 cpu and
45% done in current packet.
ex (2 cpu): OGR 12 8 2 24 78
OGR contest, 12 work units in input buffer, 8 in output buffer, 2 cpu and
24% done in current stub for cpu0, 78% for cpu1.


Misc.
=====
I have start writing a gkrellm plugin to monitor the dnetw output. But you can
write your own monitoring applet (WindowMaker Dock, Gnome/KDE applets or
epplets), I will only work on the wrapper 'dnetw' and the gkrellm plugin.

Both the wrapper and the plugin seem stable.
If you have problems, first check installation and usage section of this file.
If you still have problems you can contact me.

Laurent Papier
papier@linuxfan.com
